@import "tailwindcss" source("../ultros-frontend/ultros-app/src");

/* Legacy CSS folded into Tailwind build so brand tokens are available */
@layer base {
    /* Back-compat CSS variables that legacy selectors may reference */
    :root {
        --primary-color: var(--color-brand-700);
        --secondary-color: var(--color-brand-400);
        --background-color: var(--color-background);
        --surface-color: var(--color-background-panel);
        --text-color: var(--color-text);

        --transition-quick: 0.25s;
        --transition-medium: 0.5s;

        --spacing-sm: 5px;
        --spacing-md: 10px;
        --spacing-lg: 20px;

        /* Theme tokens: neutrals, text, outlines, brand semantics, charts */
        --color-text: #ffffff;
        --color-text-muted: #bfbfd4;
        --color-outline: rgba(255, 255, 255, 0.1);
        --color-outline-strong: rgba(255, 255, 255, 0.2);
        --brand-bg: var(--color-brand-900);
        --brand-fg: var(--color-brand-100);
        --brand-ring: var(--color-brand-400);

        --chart-line: var(--color-brand-300);
        --chart-fill: color-mix(
            in srgb,
            var(--color-brand-300) 20%,
            transparent
        );
        --chart-grid: rgba(255, 255, 255, 0.06);
        --decor-spot: rgba(255, 255, 255, 0.06);
    }

    /* Fonts (kept as-is for wide support) */
    @font-face {
        font-family: Jaldi;
        font-weight: regular;
        src: url("/static/Jaldi-Regular.ttf");
        font-display: swap;
    }

    @font-face {
        font-family: Jaldi-Bold;
        font-weight: bold;
        src: url("/static/Jaldi-Bold.ttf");
        font-display: swap;
    }

    @font-face {
        font-family: Pacifico-Regular;
        font-weight: regular;
        src: url("/static/Pacifico-Regular.ttf");
        font-display: swap;
    }

    @font-face {
        font-family: "xivicons";
        src: url("/static/classjob-icons/src/FFXIVAppIcons.eot");
        src:
            url("/static/classjob-icons/src/FFXIVAppIcons.eot?#iefix")
                format("embedded-opentype"),
            url("/static/classjob-icons/src/FFXIVAppIcons.woff") format("woff"),
            url("./FFXIVAppIcons.ttf") format("truetype"),
            url("/static/classjob-icons/src/FFXIVAppIcons.svg#FFXIVAppIcons")
                format("svg");
        font-weight: normal;
        font-style: normal;
        font-display: swap;
    }

    [class*="xiv-"]:before {
        display: inline-block;
        font-family: "xivicons";
        font-style: normal;
        font-weight: normal;
        line-height: 1;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    html {
        overflow-x: hidden;
        width: 100vw;
    }

    body {
        background-size: 500px;
        background-position: top;
        max-width: 100vw;
        background-color: var(--color-background);
        color: var(--text-color);
        position: relative;
        overflow-x: hidden;
    }

    :focus-visible {
        outline: 2px solid var(--color-brand-700);
        outline-offset: 2px;
    }

    @media (prefers-reduced-motion: reduce) {
        * {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
            scroll-behavior: auto !important;
        }
    }
}

/* Light mode overrides */
[data-theme="light"] {
    /* Surfaces */
    --color-background: #f8fafc; /* near-white */
    --color-background-muted: #eef2f7; /* subtle gray */
    --color-background-elevated: #ffffff; /* cards */
    --color-background-panel: #ffffff;

    /* Text */
    --color-text: #0b0b0c;
    --color-text-muted: #475569;

    /* Outlines and grid */
    --color-outline: rgba(0, 0, 0, 0.12);
    --color-outline-strong: rgba(0, 0, 0, 0.2);
    --chart-grid: rgba(0, 0, 0, 0.06);

    /* Flip brand semantics for light */
    --brand-bg: var(--color-brand-200);
    --brand-fg: var(--color-brand-900);
    --brand-ring: var(--color-brand-600);

    /* Decorative spot for gradients in light */
    --decor-spot: rgba(0, 0, 0, 0.06);

    /* Flip brand scale (violet) for better contrast on light backgrounds) */
    --color-brand-50: #2e1065;
    --color-brand-100: #4c1d95;
    --color-brand-200: #5b21b6;
    --color-brand-300: #6d28d9;
    --color-brand-400: #7c3aed;
    --color-brand-500: #8b5cf6;
    --color-brand-600: #a78bfa;
    --color-brand-700: #c4b5fd;
    --color-brand-800: #ddd6fe;
    --color-brand-900: #ede9fe;
    --color-brand-950: #f5f3ff;
}

/* Contrast guards: ensure readable field/dropdown surfaces in light mode */
[data-theme="light"] .input,
[data-theme="light"] input:not([type="checkbox"]):not([type="radio"]),
[data-theme="light"] select,
[data-theme="light"] textarea {
    background-color: var(--color-background-elevated);
    color: var(--color-text);
    border-color: var(--color-outline);
}

/* Light mode search dropdown container */
[data-theme="light"] .scroll-panel,
[data-theme="light"] .search-results {
    background: var(--color-background-elevated);
    background-image: none;
    border: 1px solid var(--color-outline);
    border-radius: 0.75rem;
}

/* Dark mode guard: keep high contrast for inputs as well */
[data-theme="dark"] .input,
[data-theme="dark"] input:not([type="checkbox"]):not([type="radio"]),
[data-theme="dark"] select,
[data-theme="dark"] textarea {
    background-color: var(--color-background-elevated);
    color: var(--color-text);
    border-color: var(--color-outline);
}

/* Runtime-swappable brand palettes */
:root[data-palette="violet"],
[data-theme="light"][data-palette="violet"] {
    --color-brand-50: #f5f3ff;
    --color-brand-100: #ede9fe;
    --color-brand-200: #ddd6fe;
    --color-brand-300: #c4b5fd;
    --color-brand-400: #a78bfa;
    --color-brand-500: #8b5cf6;
    --color-brand-600: #7c3aed;
    --color-brand-700: #6d28d9;
    --color-brand-800: #5b21b6;
    --color-brand-900: #4c1d95;
    --color-brand-950: #2e1065;
}
:root[data-palette="teal"],
[data-theme="light"][data-palette="teal"] {
    --color-brand-50: #f0fdfa;
    --color-brand-100: #ccfbf1;
    --color-brand-200: #99f6e4;
    --color-brand-300: #5eead4;
    --color-brand-400: #2dd4bf;
    --color-brand-500: #14b8a6;
    --color-brand-600: #0d9488;
    --color-brand-700: #0f766e;
    --color-brand-800: #115e59;
    --color-brand-900: #134e4a;
    --color-brand-950: #042f2e;
}
:root[data-palette="emerald"],
[data-theme="light"][data-palette="emerald"] {
    --color-brand-50: #ecfdf5;
    --color-brand-100: #d1fae5;
    --color-brand-200: #a7f3d0;
    --color-brand-300: #6ee7b7;
    --color-brand-400: #34d399;
    --color-brand-500: #10b981;
    --color-brand-600: #059669;
    --color-brand-700: #047857;
    --color-brand-800: #065f46;
    --color-brand-900: #064e3b;
    --color-brand-950: #022c22;
}
:root[data-palette="amber"],
[data-theme="light"][data-palette="amber"] {
    --color-brand-50: #fffbeb;
    --color-brand-100: #fef3c7;
    --color-brand-200: #fde68a;
    --color-brand-300: #fcd34d;
    --color-brand-400: #fbbf24;
    --color-brand-500: #f59e0b;
    --color-brand-600: #d97706;
    --color-brand-700: #b45309;
    --color-brand-800: #92400e;
    --color-brand-900: #78350f;
    --color-brand-950: #451a03;
}
:root[data-palette="rose"],
[data-theme="light"][data-palette="rose"] {
    --color-brand-50: #fff1f2;
    --color-brand-100: #ffe4e6;
    --color-brand-200: #fecdd3;
    --color-brand-300: #fda4af;
    --color-brand-400: #fb7185;
    --color-brand-500: #f43f5e;
    --color-brand-600: #e11d48;
    --color-brand-700: #be123c;
    --color-brand-800: #9f1239;
    --color-brand-900: #881337;
    --color-brand-950: #4c0519;
}
:root[data-palette="sky"],
[data-theme="light"][data-palette="sky"] {
    --color-brand-50: #f0f9ff;
    --color-brand-100: #e0f2fe;
    --color-brand-200: #bae6fd;
    --color-brand-300: #7dd3fc;
    --color-brand-400: #38bdf8;
    --color-brand-500: #0ea5e9;
    --color-brand-600: #0284c7;
    --color-brand-700: #0369a1;
    --color-brand-800: #075985;
    --color-brand-900: #0c4a6e;
    --color-brand-950: #082f49;
}

/* FFXIV-themed palettes */
:root[data-palette="immortal-flames"],
[data-theme="light"][data-palette="immortal-flames"] {
    /* copper and ember (distinct from tuliyollal's orange) */
    --color-brand-50: #fff3e6;
    --color-brand-100: #ffe0c2;
    --color-brand-200: #ffc896;
    --color-brand-300: #ffab63;
    --color-brand-400: #f68a2f;
    --color-brand-500: #d96a16;
    --color-brand-600: #b74f12;
    --color-brand-700: #8f3d12;
    --color-brand-800: #6d3012;
    --color-brand-900: #4c230f;
    --color-brand-950: #251108;
}

:root[data-palette="uldah"],
[data-theme="light"][data-palette="uldah"] {
    /* opulent gold and desert sand */
    --color-brand-50: #fefce8;
    --color-brand-100: #fef9c3;
    --color-brand-200: #fef08a;
    --color-brand-300: #fde047;
    --color-brand-400: #facc15;
    --color-brand-500: #eab308;
    --color-brand-600: #ca8a04;
    --color-brand-700: #a16207;
    --color-brand-800: #854d0e;
    --color-brand-900: #713f12;
    --color-brand-950: #422006;
}

:root[data-palette="limsa"],
[data-theme="light"][data-palette="limsa"] {
    /* nautical indigo */
    --color-brand-50: #eef2ff;
    --color-brand-100: #e0e7ff;
    --color-brand-200: #c7d2fe;
    --color-brand-300: #a5b4fc;
    --color-brand-400: #818cf8;
    --color-brand-500: #6366f1;
    --color-brand-600: #4f46e5;
    --color-brand-700: #4338ca;
    --color-brand-800: #3730a3;
    --color-brand-900: #312e81;
    --color-brand-950: #1e1b4b;
}

:root[data-palette="garlemald"],
[data-theme="light"][data-palette="garlemald"] {
    /* industrial slate */
    --color-brand-50: #f8fafc;
    --color-brand-100: #f1f5f9;
    --color-brand-200: #e2e8f0;
    --color-brand-300: #cbd5e1;
    --color-brand-400: #94a3b8;
    --color-brand-500: #64748b;
    --color-brand-600: #475569;
    --color-brand-700: #334155;
    --color-brand-800: #1f2937;
    --color-brand-900: #0f172a;
    --color-brand-950: #020617;
}
:root[data-palette="ultros"],
[data-theme="light"][data-palette="ultros"] {
    /* signature voidsent purple */
    --color-brand-50: #f5f3ff;
    --color-brand-100: #ede9fe;
    --color-brand-200: #ddd6fe;
    --color-brand-300: #c4b5fd;
    --color-brand-400: #a78bfa;
    --color-brand-500: #8b5cf6;
    --color-brand-600: #7c3aed;
    --color-brand-700: #6d28d9;
    --color-brand-800: #5b21b6;
    --color-brand-900: #4c1d95;
    --color-brand-950: #2e1065;
}

:root[data-palette="maelstrom"],
[data-theme="light"][data-palette="maelstrom"] {
    /* naval crimson + brass */
    --color-brand-50: #fef2f2;
    --color-brand-100: #fee2e2;
    --color-brand-200: #fecaca;
    --color-brand-300: #fca5a5;
    --color-brand-400: #f87171;
    --color-brand-500: #ef4444;
    --color-brand-600: #dc2626;
    --color-brand-700: #b91c1c;
    --color-brand-800: #991b1b;
    --color-brand-900: #7f1d1d;
    --color-brand-950: #450a0a;
}

:root[data-palette="twin-adder"],
[data-theme="light"][data-palette="twin-adder"] {
    /* woodland emerald with serpent amber accents */
    --color-brand-50: #ecfdf5;
    --color-brand-100: #d1fae5;
    --color-brand-200: #a7f3d0;
    --color-brand-300: #6ee7b7;
    --color-brand-400: #34d399;
    --color-brand-500: #10b981;
    --color-brand-600: #059669;
    --color-brand-700: #047857;
    --color-brand-800: #065f46;
    --color-brand-900: #064e3b;
    --color-brand-950: #022c22;
}

:root[data-palette="ascian"],
[data-theme="light"][data-palette="ascian"] {
    /* void black + amaranth */
    --color-brand-50: #fff1f2;
    --color-brand-100: #ffe4e6;
    --color-brand-200: #fecdd3;
    --color-brand-300: #fda4af;
    --color-brand-400: #fb7185;
    --color-brand-500: #f43f5e;
    --color-brand-600: #e11d48;
    --color-brand-700: #be123c;
    --color-brand-800: #9f1239;
    --color-brand-900: #881337;
    --color-brand-950: #4c0519;
}

:root[data-palette="ishgard"],
[data-theme="light"][data-palette="ishgard"] {
    /* frost + silver (sky blues) */
    --color-brand-50: #f0f9ff;
    --color-brand-100: #e0f2fe;
    --color-brand-200: #bae6fd;
    --color-brand-300: #7dd3fc;
    --color-brand-400: #38bdf8;
    --color-brand-500: #0ea5e9;
    --color-brand-600: #0284c7;
    --color-brand-700: #0369a1;
    --color-brand-800: #075985;
    --color-brand-900: #0c4a6e;
    --color-brand-950: #082f49;
}

:root[data-palette="crystarium"],
[data-theme="light"][data-palette="crystarium"] {
    /* aurora violet with crystalline glow (fuchsia) */
    --color-brand-50: #fdf4ff;
    --color-brand-100: #fae8ff;
    --color-brand-200: #f5d0fe;
    --color-brand-300: #f0abfc;
    --color-brand-400: #e879f9;
    --color-brand-500: #d946ef;
    --color-brand-600: #c026d3;
    --color-brand-700: #a21caf;
    --color-brand-800: #86198f;
    --color-brand-900: #701a75;
    --color-brand-950: #4a044e;
}

:root[data-palette="sharlayan"],
[data-theme="light"][data-palette="sharlayan"] {
    /* deep academy blue + parchment */
    --color-brand-50: #eff6ff;
    --color-brand-100: #dbeafe;
    --color-brand-200: #bfdbfe;
    --color-brand-300: #93c5fd;
    --color-brand-400: #60a5fa;
    --color-brand-500: #3b82f6;
    --color-brand-600: #2563eb;
    --color-brand-700: #1d4ed8;
    --color-brand-800: #1e40af;
    --color-brand-900: #1e3a8a;
    --color-brand-950: #172554;
}

:root[data-palette="tuliyollal"],
[data-theme="light"][data-palette="tuliyollal"] {
    /* terracotta heat + jungle warmth (orange) */
    --color-brand-50: #fff7ed;
    --color-brand-100: #ffedd5;
    --color-brand-200: #fed7aa;
    --color-brand-300: #fdba74;
    --color-brand-400: #fb923c;
    --color-brand-500: #f97316;
    --color-brand-600: #ea580c;
    --color-brand-700: #c2410c;
    --color-brand-800: #9a3412;
    --color-brand-900: #7c2d12;
    --color-brand-950: #431407;
}

@layer components {
    /* Hero title */
    .hero-title {
        margin-top: 15%;
        margin-left: 10%;
        text-shadow: -5px -5px 10px #000;
        font-size: 76px;
        margin-bottom: 10%;
        font-family: "Pacifico-Regular";
    }

    /* Search UI */
    .search-container {
        align-items: top;
        position: relative;
        height: 52px;
    }

    .search-box {
        height: 36px;
        margin: 5px;
        padding: 0 10px;
        flex-direction: column;
        font-family: inherit;
        font-size: large;
        color: var(--color-text);
        background-color: var(--color-background-panel);
        border: 1px solid var(--color-outline);
        border-radius: 4px;
        transition: 0.5s 0s cubic-bezier(0.075, 0.82, 0.165, 1) background-color;
    }

    .search-box:hover {
        background-color: var(--color-background-elevated);
        transition: 0.5s 0s cubic-bezier(0.075, 0.82, 0.165, 1) background-color;
    }

    .search-box.active,
    .search-box:active {
        background-color: var(--color-brand-900);
        transition: 0.5s 0s cubic-bezier(0.075, 0.82, 0.165, 1) background-color;
        border: 1px solid var(--color-brand-400);
        border-bottom: 0;
    }

    .search-box.active ~ .search-results,
    .search-box:active ~ .search-results,
    .search-results:focus-within {
        visibility: visible;
        opacity: 1;
        animation: 0.25s cubic-bezier(0.76, 0, 0.24, 1) search-open;
        height: 500px;
        border-top: 0;
        margin-top: -5px;
    }

    .search-results:hover {
        visibility: visible;
    }

    .search-results {
        background-color: var(--color-background-elevated);
        display: flex;
        flex-direction: column;
        align-items: center;
        height: 0;
        position: relative;
        overflow-y: scroll;
        overflow-x: hidden;
        opacity: 0;
        z-index: 100;
        margin-top: -2px;
        border: 1px solid var(--color-outline);
        border-radius: 0 0 5px 5px;
    }

    .search-result {
        display: flex;
        text-align: left;
        justify-content: left;
        align-items: center;
        width: 424px;
        height: 40px;
        background-color: var(--color-background);
        animation-duration: 0.1s;
        animation-timing-function: cubic-bezier(0.24, 0.27, 0.18, 0.81);
        transition: background-color 1s;
        border: 1px solid var(--color-background-muted);
    }

    .search-result:hover {
        background-color: var(--color-brand-900);
    }

    .item-name > b {
        color: var(--color-brand-500);
    }

    .item-name {
        font-size: 16px;
        text-align: left;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: clip;
    }

    .item-type {
        font-size: 14px;
        text-align: left;
    }

    .avatar {
        width: 32px;
        height: 32px;
        padding: 0;
        border-radius: 9999px;
        border-radius: 36px;
        padding: 5px;
    }

    /* Tooltip */
    .tooltip {
        display: inline-flex;
        position: relative;
        text-align: left;
    }

    .tooltip .tooltip-text {
        bottom: 100%;
        left: 50%;
        min-width: 125px;
        margin-left: -100%;
    }

    .tooltip:hover .tooltip-text {
        visibility: visible;
        animation: fadeInAnimation cubic-bezier(0.11, 0, 0.5, 0) 0.25s;
    }

    /* Tables */
    .main-content table {
        border-collapse: separate;
        border-spacing: 0;
        width: 100%;
    }

    .main-content th {
        position: sticky;
        top: 0;
        background: var(--color-background);
        z-index: 10;
        padding: var(--spacing-md);
    }

    .main-content td {
        padding: var(--spacing-md);
        border-bottom: 1px solid var(--color-outline);
    }

    .content-well {
        margin: 1.5rem;
        padding: 1rem 3rem;
        border-radius: 1rem;
        background-color: var(--color-background-elevated);
        border: 1px solid var(--color-outline);
    }

    .content-title {
        font-size: 26px;
    }

    /* Homeworld badge */
    .homeworld {
        background-color: var(--color-brand-950);
        color: var(--color-brand-200);
    }

    .homeworld::before {
        content: "ðŸ ";
    }

    /* Dropdown */
    .drop-hint {
        background-color: var(--color-brand-900);
        border: 1px solid var(--color-brand-300);
    }

    /* Spinner (used by loading indicators) */
    .lds-ellipsis {
        display: inline-block;
        position: relative;
        width: 25px;
        height: 18px;
    }

    .lds-ellipsis div {
        position: absolute;
        top: 33px;
        width: 13px;
        height: 13px;
        border-radius: 50%;
        background: #fff;
        animation-timing-function: cubic-bezier(0, 1, 1, 0);
    }

    .lds-ellipsis div:nth-child(1) {
        left: 2px;
        animation: lds-ellipsis1 0.6s infinite;
    }
    .lds-ellipsis div:nth-child(2) {
        left: 3px;
        animation: lds-ellipsis2 0.6s infinite;
    }
    .lds-ellipsis div:nth-child(3) {
        left: 10px;
        animation: lds-ellipsis2 0.6s infinite;
    }
    .lds-ellipsis div:nth-child(4) {
        left: 18px;
        animation: lds-ellipsis3 0.6s infinite;
    }
}

/* Keyframes from legacy */
@keyframes fadeInAnimation {
    0% {
        opacity: 0;
    }
    100% {
        opacity: 1;
    }
}

@keyframes search-open {
    0% {
        height: 0px;
    }
    100% {
        height: 500px;
    }
}

@keyframes lds-ellipsis1 {
    0% {
        transform: scale(0);
    }
    100% {
        transform: scale(1);
    }
}

@keyframes lds-ellipsis3 {
    0% {
        transform: scale(1);
    }
    100% {
        transform: scale(0);
    }
}

@keyframes lds-ellipsis2 {
    0% {
        transform: translate(0, 0);
    }
    100% {
        transform: translate(24px, 0);
    }
}

@theme {
    /* Custom violet scale tuned for dark UI */
    --color-brand-50: #f6f2ff;
    --color-brand-100: #ede8ff;
    --color-brand-200: #d8d0ff;
    --color-brand-300: #beaefc;
    --color-brand-400: #a38af7;
    --color-brand-500: #8b67f0;
    --color-brand-600: #744ee2;
    --color-brand-700: #5e3ccd;
    --color-brand-800: #4930a8;
    --color-brand-900: #37267f;
    --color-brand-950: #1a1538;

    /* Brand alias (single + scale) */
    --color-brand: #8b5cf6;
    --color-brand-50: #f5f3ff;
    --color-brand-100: #ede9fe;
    --color-brand-200: #ddd6fe;
    --color-brand-300: #c4b5fd;
    --color-brand-400: #a78bfa;
    --color-brand-500: #8b5cf6;
    --color-brand-600: #7c3aed;
    --color-brand-700: #6d28d9;
    --color-brand-800: #5b21b6;
    --color-brand-900: #4c1d95;
    --color-brand-950: #2e1065;

    /* Dark background tokens */
    --color-background: #0a0a0b;
    --color-background-muted: #0d0c12;
    --color-background-elevated: #11101a;
    --color-background-panel: #0f0e16;
}

.btn {
    color: var(--color-text);
    cursor: pointer;
}
.btn:hover {
    color: var(--brand-fg);
}
.btn-primary {
    cursor: pointer;
}

a:not(.nav-link):not(.btn):not(.btn-primary):not(.btn-secondary):not(
        .btn-ghost
    ) {
    @apply hover:underline rounded-md;
    color: var(--brand-fg);
    background-color: transparent;
}
a:not(.nav-link):not(.btn):not(.btn-primary):not(.btn-secondary):not(
        .btn-ghost
    ):hover {
    color: color-mix(in srgb, var(--brand-ring) 60%, var(--brand-fg));
    background-color: color-mix(in srgb, var(--brand-ring) 22%, transparent);
}

/* Light-mode link tuning for higher contrast */
[data-theme="light"]
    a:not(.nav-link):not(.btn):not(.btn-primary):not(.btn-secondary):not(
        .btn-ghost
    ) {
    color: color-mix(in srgb, var(--brand-ring) 70%, var(--color-text));
}
[data-theme="light"]
    a:not(.nav-link):not(.btn):not(.btn-primary):not(.btn-secondary):not(
        .btn-ghost
    ):hover {
    color: color-mix(in srgb, var(--brand-ring) 85%, var(--color-text));
    background-color: color-mix(in srgb, var(--brand-ring) 28%, transparent);
}

/* Light-mode text utility fixes for contrast */
[data-theme="light"] .text-gray-300,
[data-theme="light"] .text-slate-300,
[data-theme="light"] .text-zinc-300 {
    color: var(--color-text);
}
/* Use darker brand tones for text on light backgrounds */
[data-theme="light"] .text-brand-200,
[data-theme="light"] .text-brand-300 {
    color: var(--color-brand-700);
}

/* Ghost button: increase contrast in light mode */
[data-theme="light"] .btn-ghost {
    border-color: var(--color-outline);
    color: var(--color-text);
    background-color: transparent;
}
[data-theme="light"] .btn-ghost:hover {
    background-color: color-mix(in srgb, var(--brand-ring) 14%, transparent);
    color: var(--color-text);
}

.btn-secondary {
    @apply p-2 m-1 flex flex-row text-center rounded-2xl transition-all duration-300 ease-in-out justify-center gap-3;
    color: var(--color-text);
    cursor: pointer;
    background-color: color-mix(
        in srgb,
        var(--brand-bg) 10%,
        var(--color-background-elevated)
    );
    border: 1px solid var(--color-outline);
    backdrop-filter: blur(6px);
}

.btn-secondary > * {
    @apply text-xl font-extrabold rounded-xl;
    color: var(--color-text);
}

[aria-current="page"].btn-secondary {
    background-color: color-mix(
        in srgb,
        var(--brand-ring) 22%,
        var(--color-background-elevated)
    );
    border-color: color-mix(
        in srgb,
        var(--brand-ring) 40%,
        var(--color-outline)
    );
    color: var(--color-text);
}

/* Design system: panels, cards, nav links, buttons, inputs, kbd, and utilities */
@utility panel {
    @apply rounded-xl border;
    border-color: var(--color-outline);
    /* base panel surface */
    background-color: var(--color-background-elevated);
    /* subtle dark-mode gradient shading like settings world panel */
    background-image:
        radial-gradient(
            1200px 600px at 50% -20%,
            var(--decor-spot),
            transparent 60%
        ),
        linear-gradient(
            135deg,
            color-mix(in srgb, var(--brand-bg) 6%, transparent),
            color-mix(in srgb, var(--color-background) 4%, transparent)
        );
    background-blend-mode: overlay, normal;
    backdrop-filter: blur(4px);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2);
}

/* Light mode panels: keep clean, high-contrast surfaces */
[data-theme="light"] .panel {
    background-image: none;
    background-color: var(--color-background-elevated);
}

@utility card {
    @apply rounded-xl p-4 transition-all duration-300 border;
    border-color: color-mix(
        in srgb,
        var(--brand-ring) 18%,
        var(--color-outline)
    );
    background-color: var(--color-background-elevated);
    background-image:
        radial-gradient(
            1000px 500px at 50% -20%,
            var(--decor-spot),
            transparent 60%
        ),
        linear-gradient(
            135deg,
            color-mix(in srgb, var(--brand-bg) 6%, transparent),
            color-mix(in srgb, var(--color-background) 4%, transparent)
        );
    background-blend-mode: overlay, normal;
    box-shadow:
        0 12px 24px -12px rgba(0, 0, 0, 0.28),
        0 4px 8px -6px rgba(0, 0, 0, 0.16);
    outline: 1px solid transparent;
    @apply bg-blend-overlay;
    @apply hover:-translate-y-0.5 active:translate-y-0 focus-visible:outline-none;
}
.card:hover {
    box-shadow:
        0 16px 28px -12px rgba(0, 0, 0, 0.34),
        0 6px 12px -8px rgba(0, 0, 0, 0.2);
    outline-color: color-mix(in srgb, var(--brand-ring) 35%, transparent);
}
[data-theme="light"] .card {
    background-image: none;
    background-color: var(--color-background-elevated);
    border-color: color-mix(
        in srgb,
        var(--brand-ring) 24%,
        var(--color-outline)
    );
    box-shadow:
        0 10px 16px -12px rgba(0, 0, 0, 0.12),
        0 4px 6px -6px rgba(0, 0, 0, 0.08);
}

@utility input {
    @apply rounded-lg px-3 py-2 border transition-colors duration-150;
    background-color: var(--color-background-elevated);
    color: var(--color-text);
    border-color: var(--color-outline);
}

/* Placeholder contrast */
.input::placeholder {
    color: var(--color-text-muted);
}

/* Focus ring with brand tint */
.input:focus,
.input:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px color-mix(in srgb, var(--brand-ring) 30%, transparent);
    border-color: color-mix(
        in srgb,
        var(--brand-ring) 30%,
        var(--color-outline)
    );
}

/* Light mode: ensure high-contrast field surface and text */
[data-theme="light"] .input {
    background-color: var(--color-background-elevated);
    color: var(--color-text);
    border-color: var(--color-outline);
}

@utility feature-card {
    @apply relative isolate rounded-2xl border text-[color:var(--color-text)];
    border-color: color-mix(
        in srgb,
        var(--brand-ring) 22%,
        var(--color-outline)
    );
    @apply aspect-square overflow-hidden p-5;
    background-color: var(--color-background-elevated);
    background-image:
        radial-gradient(
            1200px 600px at 50% -20%,
            var(--decor-spot),
            transparent 60%
        ),
        linear-gradient(
            135deg,
            color-mix(in srgb, var(--brand-bg) 6%, transparent),
            color-mix(in srgb, var(--color-background) 4%, transparent)
        );
    @apply bg-blend-overlay;
    @apply transition-all duration-300 ease-out transform-gpu will-change-[transform];
    @apply sm:hover:-translate-y-1 sm:hover:scale-[1.02] active:translate-y-0 focus-visible:outline-none;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
}
.feature-card:hover {
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04), 0 0 20px -5px color-mix(in srgb, var(--brand-ring) 30%, transparent);
    border-color: color-mix(in srgb, var(--brand-ring) 50%, var(--color-outline));
}

/* Sheen sweep (GPU-only transforms) */
.feature-card::before {
    content: "";
    position: absolute;
    top: -20%;
    left: -60%;
    width: 60%;
    height: 140%;
    transform: skewX(-20deg) translateX(0);
    background: linear-gradient(
        90deg,
        transparent 0%,
        var(--color-outline-strong) 50%,
        transparent 100%
    );
    opacity: 0;
    transition:
        opacity 200ms ease,
        transform 400ms ease;
    pointer-events: none;
    border-radius: inherit;
}
.group:hover .feature-card::before {
    opacity: 1;
    transform: skewX(-20deg) translateX(320%);
}

/* Animated border ring (runs only on hover) */
.feature-card::after {
    content: "";
    position: absolute;
    inset: 0;
    padding: 1px;
    border-radius: inherit;
    background: conic-gradient(
        from 0deg,
        color-mix(in srgb, var(--color-brand-400) 20%, transparent),
        transparent 35%,
        transparent 65%,
        color-mix(in srgb, var(--color-brand-400) 20%, transparent)
    );
    -webkit-mask:
        linear-gradient(#000 0 0) content-box,
        linear-gradient(#000 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    pointer-events: none;
    opacity: 0;
    transform-origin: 50% 50%;
    transition: opacity 200ms ease;
}
.group:hover .feature-card::after {
    opacity: 1;
    animation: feature-ring-spin 4s linear infinite;
}
@keyframes feature-ring-spin {
    to {
        transform: rotate(360deg);
    }
}

@utility feature-card-content {
    @apply flex flex-col items-center justify-center text-center gap-2 w-full min-w-0;
}

@utility feature-card-title {
    @apply relative font-extrabold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-brand-200 to-brand-100 group-hover:from-brand-100 group-hover:to-brand-300 transition-colors duration-150;
}
/* Title underline accent */
.feature-card-title::after {
    content: "";
    position: absolute;
    left: 50%;
    bottom: -0.35rem;
    transform: translateX(-50%);
    width: 0%;
    height: 2px;
    background: linear-gradient(90deg, var(--color-brand-300), transparent);
    transition: width 200ms ease;
    border-radius: 9999px;
}
.group:hover .feature-card-title::after {
    width: 60%;
}

/* Light mode: stronger feature card contrast */
[data-theme="light"] .feature-card {
    background-image: none;
    background-color: var(--color-background-elevated);
    border-color: color-mix(
        in srgb,
        var(--brand-ring) 18%,
        var(--color-outline)
    );
}
[data-theme="light"] .feature-card-desc {
    color: var(--color-text);
}
[data-theme="light"] .feature-card-title {
    background-image: linear-gradient(
        90deg,
        var(--color-brand-800),
        var(--color-brand-600)
    );
}
[data-theme="light"] .group:hover .feature-card-title {
    background-image: linear-gradient(
        90deg,
        var(--color-brand-900),
        var(--color-brand-700)
    );
}

@utility feature-card-desc {
    @apply text-sm md:text-base;
    color: var(--color-text);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

@utility feature-card-icon {
    @apply w-14 h-14 md:w-16 md:h-16 p-3 rounded-xl transition-colors duration-150 transform-gpu group-hover:scale-[1.02];
    color: var(--brand-ring);
}
/* Tasteful hover glow for icon (no ring/shadow) */
.group:hover .feature-card-icon {
    background: radial-gradient(
        40% 40% at 50% 50%,
        rgba(167, 139, 250, 0.16),
        transparent 70%
    );
    color: var(--color-text);
}

@utility feature-badge {
    @apply inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold;
    background-color: color-mix(in srgb, var(--brand-bg) 40%, transparent);
    color: var(--brand-fg);
    border: 1px solid color-mix(in srgb, var(--brand-ring) 20%, transparent);
}

@utility feature-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(14rem, 1fr));
    gap: 1.5rem;
    align-items: stretch;
}

@utility nav-link {
    @apply flex items-center gap-2 px-3 py-2 rounded-lg transition-colors;
    color: var(--color-text);
    border: 1px solid
        color-mix(in srgb, var(--brand-ring) 24%, var(--color-outline));
    background-color: color-mix(in srgb, var(--brand-ring) 16%, transparent);
    min-height: 40px;
    min-width: 40px;
    line-height: 1;
}
.nav-link:hover {
    background-color: color-mix(in srgb, var(--brand-ring) 28%, transparent);
    border-color: color-mix(
        in srgb,
        var(--brand-ring) 40%,
        var(--color-outline)
    );
}

.nav-link[aria-current="page"] {
    background-color: color-mix(in srgb, var(--brand-ring) 32%, transparent);
    border-color: color-mix(
        in srgb,
        var(--brand-ring) 50%,
        var(--color-outline)
    );
    color: var(--color-text);
}

/* Normalize icon sizing inside nav */
.app-nav .nav-link > svg {
    width: 1.25em;
    height: 1.25em;
}

/* Ensure avatar matches nav icon sizing and remove extra padding */
.app-nav .nav-link img.avatar {
    width: 32px;
    height: 32px;
    border-radius: 9999px;
    padding: 0;
    object-fit: cover;
}

/* Let search expand fully across available space on large screens */
.app-nav .max-w-xl {
    max-width: none;
}

/* Buttons */
.app-nav {
    background-color: color-mix(
        in srgb,
        var(--color-background) 70%,
        transparent
    );
    border-bottom: 1px solid var(--color-outline);
    backdrop-filter: blur(20px);
    color: var(--color-text);
}
@utility btn {
    @apply inline-flex items-center justify-center gap-2
    px-3 py-2 rounded-lg
    transition-all duration-200
    leading-none
    focus:outline-none focus-visible:ring-2
    active:scale-[0.98];
    color: var(--color-text);
}

/* Ensure inline icons sit perfectly centered beside text */
.btn > svg,
.btn-primary > svg,
.btn-secondary > svg {
    vertical-align: middle;
}

@utility btn-primary {
    @apply btn px-4 font-semibold shadow-lg shadow-brand-900/20;
    border: 1px solid color-mix(in srgb, var(--brand-ring) 30%, transparent);
    color: var(--brand-fg);
    background-image: linear-gradient(
        135deg,
        color-mix(in srgb, var(--brand-bg) 20%, transparent),
        color-mix(in srgb, var(--brand-bg) 10%, transparent)
    );
    background-color: color-mix(in srgb, var(--brand-bg) 15%, transparent);
}
.btn-primary:hover {
    background-color: color-mix(in srgb, var(--brand-bg) 25%, transparent);
    border-color: var(--brand-ring);
    box-shadow: 0 0 15px -3px color-mix(in srgb, var(--brand-ring) 40%, transparent);
}

@utility btn-secondary {
    @apply btn;
    border: 1px solid var(--color-outline);
    color: var(--color-text);
    background-color: color-mix(in srgb, var(--color-text) 5%, transparent);
}

@utility btn-ghost {
    @apply inline-flex items-center justify-center gap-2
    px-3 py-2 rounded-lg
    border border-white/5 bg-transparent
    hover:bg-white/5 transition-colors
    text-gray-200 hover:text-white;
}

@utility btn-danger {
    @apply inline-flex items-center justify-center gap-2
    px-4 py-2 rounded-lg
    bg-red-600/20 hover:bg-red-600/30
    border border-red-400/10 hover:border-red-400/20
    transition-all duration-200
    text-red-100;
}

/* Inputs */
@utility input-base {
    @apply w-full px-3 py-2 rounded-lg transition-all duration-200;
    background-color: var(--color-background-panel);
    border: 1px solid var(--color-outline);
    color: var(--color-text);
}

@utility input {
    @apply input-base;
}

@utility select {
    @apply input-base;
}

@utility textarea {
    @apply input-base min-h-24;
}

@utility input-sm {
    @apply px-2 py-1 text-sm;
}

@utility input-lg {
    @apply px-4 py-3 text-lg;
}

/* KBD */
@utility kbd {
    @apply inline-block px-2 py-0.5 rounded-md
    border border-white/10 bg-black/40
    text-gray-300 text-xs font-mono shadow-inner;
}

/* Utilities */
@utility surface-blur {
    @apply backdrop-blur-md;
}

@utility elevated {
    @apply shadow-lg shadow-black/40;
}

@utility divider {
    @apply w-full h-px bg-white/10;
}

@utility muted {
    @apply text-gray-400;
}

@utility gradient-ring {
    @apply ring-1;
    --tw-ring-color: color-mix(in srgb, var(--brand-ring) 20%, transparent);
}

@utility scroll-panel {
    @apply max-h-[500px] overflow-y-auto overflow-x-hidden rounded-lg border;
    /* Firefox */
    scrollbar-width: thin;
    scrollbar-color: color-mix(in srgb, var(--color-brand-600) 50%, transparent)
        transparent;
}

[data-theme="dark"] .scroll-panel {
    @apply border-white/10 bg-gradient-to-br from-brand-950/90 to-brand-900/85 backdrop-blur-md shadow-lg shadow-black/50;
}
/* WebKit */
.scroll-panel::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}
.scroll-panel::-webkit-scrollbar-track {
    background: transparent;
}
.scroll-panel::-webkit-scrollbar-thumb {
    background-color: color-mix(
        in srgb,
        var(--color-brand-600) 50%,
        transparent
    );
    border-radius: 9999px;
}
.scroll-panel::-webkit-scrollbar-thumb:hover {
    background-color: var(--color-brand-600);
}

/* Performance utilities for virtualization and large lists */
@utility content-auto {
    content-visibility: auto;
}
@utility content-visible {
    content-visibility: visible;
}

/* Containment helpers to isolate heavy subtrees */
@utility contain-strict {
    contain: strict;
}
@utility contain-content {
    contain: content;
}
@utility contain-layout {
    contain: layout;
}
@utility contain-size {
    contain: size;
}
@utility contain-paint {
    contain: paint;
}
@utility contain-style {
    contain: style;
}
@utility contain-inline-size {
    contain: inline-size;
}

/* Reserve space when using content-visibility to avoid layout shifts.
   Use the one closest to your row height for virtual scrollers. */
@utility cis-40 {
    contain-intrinsic-size: 40px 1000px;
}
@utility cis-42 {
    contain-intrinsic-size: 42px 1000px;
}
@utility cis-64 {
    contain-intrinsic-size: 64px 1000px;
}

/* Rendering hints */
@utility will-change-transform {
    will-change: transform;
}
@utility will-change-scroll {
    will-change: scroll-position;
}
@utility forced-layer {
    transform: translateZ(0);
}
